<?xml version="1.0" encoding="UTF-8"?>
<Workflow xmlns="http://soap.sforce.com/2006/04/metadata">
    <alerts>
        <fullName>Send_Travel_Itinerary_Email_Alert</fullName>
        <ccEmails>documentation@tripadeal.com.au</ccEmails>
        <description>Send Travel Itinerary Email Alert</description>
        <protected>false</protected>
        <recipients>
            <field>trip_purchaser_email__c</field>
            <type>email</type>
        </recipients>
        <senderAddress>documentation@tripadeal.com.au</senderAddress>
        <senderType>OrgWideEmailAddress</senderType>
        <template>Service_Cloud_Customer_Comms/TAD_AU_Your_Travel_Pack_is_ready_html</template>
    </alerts>
    <alerts>
        <fullName>Send_Travel_Itinerary_Email_Alert_NRMA</fullName>
        <ccEmails>tad@nrmatravel.com.au</ccEmails>
        <ccEmails>documentation@tripadeal.travel</ccEmails>
        <description>Send Travel Itinerary Email Alert NRMA</description>
        <protected>false</protected>
        <senderAddress>documentation@tripadeal.travel</senderAddress>
        <senderType>OrgWideEmailAddress</senderType>
        <template>Order_Emails/Travel_Itinerary_NRMA</template>
    </alerts>
    <alerts>
        <fullName>Send_Travel_Itinerary_Email_Alert_TC</fullName>
        <ccEmails>documentation@tripadeal.travel</ccEmails>
        <description>Send Travel Itinerary Email Alert TC</description>
        <protected>false</protected>
        <recipients>
            <field>agent_email__c</field>
            <type>email</type>
        </recipients>
        <senderAddress>documentation@tripadeal.travel</senderAddress>
        <senderType>OrgWideEmailAddress</senderType>
        <template>Travellers_Choice/TC_Your_Travel_Pack_is_Ready</template>
    </alerts>
    <alerts>
        <fullName>Send_Travel_Itinerary_Email_Alert_TNZ</fullName>
        <ccEmails>documentation@tripadeal.co.nz</ccEmails>
        <description>Send Travel Itinerary Email Alert TNZ</description>
        <protected>false</protected>
        <recipients>
            <field>trip_purchaser_email__c</field>
            <type>email</type>
        </recipients>
        <senderAddress>documentation@tripadeal.co.nz</senderAddress>
        <senderType>OrgWideEmailAddress</senderType>
        <template>NZ_Service_Cloud_Comms/TAD_NZ_Your_Travel_Pack_is_ready_html</template>
    </alerts>
    <alerts>
        <fullName>Send_Travel_Itinerary_Email_Alert_WT</fullName>
        <ccEmails>documentation@tripadeal.co.nz</ccEmails>
        <description>Send Travel Itinerary Email Alert WT</description>
        <protected>false</protected>
        <recipients>
            <field>trip_purchaser_email__c</field>
            <type>email</type>
        </recipients>
        <senderAddress>documentation@tripadeal.co.nz</senderAddress>
        <senderType>OrgWideEmailAddress</senderType>
        <template>World_Travel_NZ/WT_Travel_Pack_is_Ready</template>
    </alerts>
    <fieldUpdates>
        <fullName>Update_order_with_TP_link</fullName>
        <field>Travefy_Itinerary_Url__c</field>
        <formula>travefy_itinerary_url__c</formula>
        <name>Update order with TP link</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
        <targetObject>order__c</targetObject>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>sent</fullName>
        <field>TP_has_been_sent_from_AP__c</field>
        <literalValue>1</literalValue>
        <name>sent</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <outboundMessages>
        <fullName>Send_TP_from_AP</fullName>
        <apiVersion>45.0</apiVersion>
        <endpointUrl>https://hooks.zapier.com/hooks/catch/1265987/nraueq/</endpointUrl>
        <fields>Account_Phone_Number__c</fields>
        <fields>Id</fields>
        <fields>Name</fields>
        <fields>Order_Onwer__c</fields>
        <fields>Referral__c</fields>
        <fields>agent_email__c</fields>
        <fields>agent_name__c</fields>
        <fields>deal_image__c</fields>
        <fields>departures_dates__c</fields>
        <fields>option_title__c</fields>
        <fields>order__c</fields>
        <fields>order_number_text__c</fields>
        <fields>order_record_type__c</fields>
        <fields>travefy_share_url__c</fields>
        <fields>trip_purchaser_email__c</fields>
        <fields>trip_purchaser_first_name__c</fields>
        <includeSessionId>false</includeSessionId>
        <integrationUser>adam.bennett@tripadeal.co.nz</integrationUser>
        <name>Send TP from AP</name>
        <protected>false</protected>
        <useDeadLetterQueue>false</useDeadLetterQueue>
    </outboundMessages>
    <outboundMessages>
        <fullName>Workato_Travefy_Doc_Webhook</fullName>
        <apiVersion>42.0</apiVersion>
        <endpointUrl>https://www.workato.com/webhooks/notify/salesforce?sobject=Travefy_Document__c&amp;org_id=00D28000000crJf</endpointUrl>
        <fields>Id</fields>
        <includeSessionId>true</includeSessionId>
        <integrationUser>peter.russell@tripadeal.com.au</integrationUser>
        <name>Workato Travefy Doc Webhook</name>
        <protected>false</protected>
        <useDeadLetterQueue>false</useDeadLetterQueue>
    </outboundMessages>
    <rules>
        <fullName>AP Travefy Document send</fullName>
        <actions>
            <name>sent</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>Send_TP_from_AP</name>
            <type>OutboundMessage</type>
        </actions>
        <active>false</active>
        <criteriaItems>
            <field>Travefy_Document__c.Send_TP_from_AP__c</field>
            <operation>equals</operation>
            <value>True</value>
        </criteriaItems>
        <criteriaItems>
            <field>Travefy_Document__c.TP_has_been_sent_from_AP__c</field>
            <operation>equals</operation>
            <value>False</value>
        </criteriaItems>
        <description>only works for TAD AND TNZ travel packs</description>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>TP Pass link to order</fullName>
        <actions>
            <name>Update_order_with_TP_link</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>Travefy_Document__c.order_number_text__c</field>
            <operation>notEqual</operation>
        </criteriaItems>
        <description>Used to pass the TP link over to the order where it can be picked up for an Outbound email (Bon Voyage)</description>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>Workato Travefy Doc Creation</fullName>
        <actions>
            <name>Workato_Travefy_Doc_Webhook</name>
            <type>OutboundMessage</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>Travefy_Document__c.send_travefy_request__c</field>
            <operation>equals</operation>
            <value>True</value>
        </criteriaItems>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
</Workflow>
